<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>可编辑课程表</title>
    <style>
        :root {
            --primary-color: #4b6cb7;
            --secondary-color: #182848;
            --light-bg: #f5f7fa;
            --card-bg: #ffffff;
            --border-color: #e0e0e0;
            --语文-color: #ffebee;
            --音乐-color: #f3e5f5;
            --科学-color: #e3f2fd;
            --美术-color: #fff8e1;
            --劳动-color: #e8f5e9;
            --综合-color: #fbe9e7;
            --值日-color: #ffccbc;
            --上午-color: #fffbeb;
            --下午-color: #f0fdf4;
        }
      
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
      
        body {
            background-color: var(--light-bg);
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
      
        .课程表容器 {
            max-width: 1200px;
            margin: 0 auto;
        }
      
        .课程表标题 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 25px;
            text-align: center;
            border-radius: 16px;
            margin-bottom: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }
      
        .课程表标题::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }
      
        .课程表标题 h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 2;
        }
      
        .课程表标题 p {
            opacity: 0.95;
            font-size: 17px;
            font-weight: 400;
            position: relative;
            z-index: 2;
        }
      
        @keyframes shimmer {
            0% { transform: rotate(45deg) translateX(-100%); }
            100% { transform: rotate(45deg) translateX(100%); }
        }
      
        .功能栏 {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .功能栏 > div {
            display: flex;
            gap: 15px;
        }
        
        /* Todo 视图样式 */
        .todo视图 {
            display: none;
        }
        
        .todo容器 {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .todo表单 {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .todo表单组 {
            margin-bottom: 15px;
        }
        
        .todo表单组 label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        .todo表单组 input,
        .todo表单组 textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
        }
        
        .todo表单组 textarea {
            height: 80px;
            resize: vertical;
        }
        
        .todo列表 {
            display: grid;
            gap: 12px;
        }
        
        .todo卡片 {
            background: var(--card-bg);
            padding: 16px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--primary-color);
        }
        
        .todo卡片.过期 {
            border-left-color: #dc3545;
            opacity: 0.7;
        }
        
        .todo卡片.已完成 {
            border-left-color: #28a745;
            text-decoration: line-through;
            opacity: 0.7;
        }
        
        .todo卡片.已完成 .todo删除按钮 {
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        .todo标题 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .todo内容 {
            color: #666;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        
        .todo时间 {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 12px;
        }
        
        .todo操作 {
            display: flex;
            gap: 10px;
        }
        
        .todo按钮 {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .todo完成按钮 {
            background-color: #28a745;
            color: white;
        }
        
        .todo删除按钮 {
            background-color: #dc3545;
            color: white;
        }
        
        /* 日期分组样式 */
        .todo日期分组 {
            margin-bottom: 24px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .todo日期标题 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            font-weight: 600;
            font-size: 16px;
        }
        
        .todo日期内容 {
            padding: 16px;
            background: #f8fafc;
            display: grid;
            gap: 12px;
        }
        
        .todo日期内容 .todo卡片 {
            margin: 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
      
        .按钮 {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
      
        .主按钮 {
            background-color: var(--primary-color);
            color: white;
        }
      
        .次按钮 {
            background-color: #6c757d;
            color: white;
        }
      
        .按钮:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
      
        .星期导航 {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            margin-bottom: 20px;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
      
        .星期标签 {
            padding: 15px 20px;
            cursor: pointer;
            text-align: center;
            flex: 1;
            min-width: 120px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .星期一 { background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%); color: #c62828; }
        .星期二 { background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%); color: #1565c0; }
        .星期三 { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); color: #2e7d32; }
        .星期四 { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); color: #ff8f00; }
        .星期五 { background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%); color: #558b2f; }
        .星期六 { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); color: #7b1fa2; }
        .星期日 { background: linear-gradient(135deg, #fad0c4 0%, #ffd1ff 100%); color: #ad1457; }
      
        .星期标签:hover {
            background-color: #f0f5ff;
        }
      
        .星期标签.活跃 {
            border-bottom: 3px solid var(--primary-color);
            color: var(--primary-color);
            font-weight: bold;
        }
      
        .课程内容 {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }
      
        .课程卡片 {
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            border: 1px solid #e0e0e0;
            position: relative;
            overflow: hidden;
        }
      
        .课程卡片:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
      
        .课程头 {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
      
        .课程时间 {
            font-weight: 600;
            color: #4a5568;
            font-size: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            padding: 4px 12px;
            border-radius: 20px;
            display: inline-block;
            border: 1px solid #e2e8f0;
            letter-spacing: 0.3px;
        }
      
        .操作按钮 {
            display: flex;
            gap: 10px;
        }
      
        .图标按钮 {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #6c757d;
            transition: color 0.3s ease;
        }
      
        .图标按钮:hover {
            color: var(--primary-color);
        }
      
        .课程详情 {
            margin-bottom: 16px;
        }
      
        .课程科目 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #2c3e50;
            letter-spacing: 0.5px;
            position: relative;
            padding-bottom: 8px;
        }
      
        .课程科目::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), transparent);
            border-radius: 2px;
        }
      
        .语文::before { content: '📚 '; }
        .音乐::before { content: '🎵 '; }
        .科学::before { content: '🔬 '; }
        .美术::before { content: '🎨 '; }
        .劳动::before { content: '🧹 '; }
        .综合::before { content: '📝 '; }
        .值日::before { content: '🧽 '; }
        
        .语文 { color: #c62828; }
        .音乐 { color: #7b1fa2; }
        .科学 { color: #1565c0; }
        .美术 { color: #ff8f00; }
        .劳动 { color: #2e7d32; }
        .综合 { color: #d84315; }
        .值日 { color: #bf360c; }
      
        .课程信息 {
            color: #666;
            margin-bottom: 6px;
            font-size: 14px;
            line-height: 1.4;
        }
      
        .编辑表单 {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
      
        .表单组 {
            margin-bottom: 15px;
        }
      
        .表单组 label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
      
        .表单组 input, .表单组 select {
            width: auto;
            max-width: 200px;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 16px;
        }
      
        .表单按钮 {
            display: flex;
            gap: 10px;
        }
      
        .空状态 {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            grid-column: 1 / -1;
        }
      
        .新增课程卡片 {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px dashed var(--border-color);
        }
      
        .新增课程卡片:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
        }
      
        .新增图标 {
            font-size: 32px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
      
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .课程表容器 {
                max-width: 100%;
            }
            
            .课程表标题 {
                padding: 15px;
                border-radius: 8px;
            }
            
            .课程表标题 h1 {
                font-size: 20px;
            }
            
            .课程表标题 p {
                font-size: 14px;
            }
            
            .功能栏 {
                flex-direction: column;
                gap: 8px;
            }
            
            .按钮 {
                padding: 8px 16px;
                font-size: 14px;
                width: 100%;
                text-align: center;
            }
            
            .星期导航 {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                margin-bottom: 15px;
            }
            
            .星期标签 {
                min-width: 70px;
                padding: 12px 15px;
                font-size: 14px;
            }
            
            .课程内容 {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .课程卡片 {
                padding: 16px;
                border-radius: 8px;
                backdrop-filter: none;
            }
            
            .课程头 {
                flex-direction: row;
                align-items: center;
                gap: 12px;
            }
          
            .操作按钮 {
                margin-left: auto;
            }
            
            .课程科目 {
                font-size: 16px;
                padding: 6px 12px;
                border-radius: 10px;
            }
            
            .课程信息 {
                font-size: 14px;
            }
            
            .视图切换 {
                flex-direction: column;
                gap: 5px;
                padding: 10px;
            }
            
            .视图按钮 {
                width: 100%;
                margin: 2px 0;
            }
            
            .课程表格容器 {
                padding: 15px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .课程表格 {
                min-width: 600px;
            }
            
            .课程表格 th,
            .课程表格 td {
                padding: 8px 10px;
                font-size: 12px;
            }
            
            .课程单元格 .科目标签 {
                font-size: 11px;
                padding: 3px 6px;
            }
            
            .课程单元格 .班级信息,
            .课程单元格 .教师信息 {
                font-size: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .课程表标题 h1 {
                font-size: 18px;
            }
            
            .课程表标题 p {
                font-size: 12px;
            }
            
            .星期标签 {
                min-width: 60px;
                padding: 10px 12px;
                font-size: 12px;
            }
            
            .课程内容 {
                gap: 8px;
            }
            
            .课程卡片 {
                padding: 12px;
                border-radius: 6px;
            }
            
            .课程头 {
                flex-direction: row;
                align-items: center;
                gap: 8px;
            }
          
            .操作按钮 {
                margin-left: auto;
            }
            
            .课程科目 {
                font-size: 15px;
            }
            
            .表单组 input, .表单组 select {
                font-size: 14px;
                padding: 8px;
                width: auto;
                max-width: 150px;
            }
            
            /* 手机端表格适配 */
            .课程表格容器 {
                padding: 10px 5px;
                margin: 0 -5px;
            }
            
            .课程表格 {
                width: 100%;
                font-size: 11px;
                table-layout: fixed;
            }
            
            .课程表格 th,
            .课程表格 td {
                padding: 4px 2px;
                font-size: 10px;
                word-wrap: break-word;
            }
            
            .课程单元格 .科目标签 {
                font-size: 10px;
                padding: 2px 4px;
            }
            
            .课程单元格 .班级信息,
            .课程单元格 .教师信息 {
                font-size: 9px;
            }
        }
      
        /* 动画效果 */
        @keyframes 淡入 {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .课程卡片 {
            animation: 淡入 0.5s ease forwards;
        }
        
        /* 表格视图样式 */
        .视图切换 {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            background: var(--card-bg);
            border-radius: 8px;
            padding: 5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .视图按钮 {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: transparent;
            transition: all 0.3s ease;
            margin: 0 5px;
        }
        
        .视图按钮.active {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
        }
        
        .课程表格容器 {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            overflow-x: auto;
            display: none;
        }
        
        .课程表格 {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .课程表格 th,
        .课程表格 td {
            padding: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        .课程表格 th {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .课程表格 tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .课程表格 tr:hover {
            background-color: #f0f5ff;
        }
        
        .课程表格 .课程单元格 {
            min-width: 60px;
            padding: 6px;
        }
        
        .课程单元格 .科目标签 {
            padding: 5px 8px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 4px;
        }
        
        .课程单元格 .班级信息 {
            font-size: 12px;
            color: #666;
        }
        
        .课程单元格 .教师信息 {
            font-size: 12px;
            color: #888;
        }
        
        .空单元格 {
            background-color: #fafafa;
        }
    </style>
</head>
<body>
    <div class="课程表容器">
        <div class="课程表标题">
            <h1>优秀教师的自我修养</h1>
            <p>可编辑的个人课程表、常用工具</p>
        </div>
      
        <div class="功能栏">
            <div>
                <!-- 添加新课程按钮已删除 -->
            </div>
            <div>
                <!-- Todo提醒按钮已删除 -->
            </div>
        </div>
        
        <!-- 视图切换按钮 -->
        <div class="视图切换">
            <button class="视图按钮 active" id="卡片视图">卡片视图</button>
            <button class="视图按钮" id="表格视图">表格视图</button>
            <button class="视图按钮" id="todo视图按钮">Todo提醒</button>
            <!-- <button class="视图按钮" onclick="重置课程表()">重置课程表</button> -->
        </div>
        
        <div class="星期导航">
            <div class="星期标签 活跃" data-星期="全部">全部</div>
            <div class="星期标签" data-星期="周一">周一</div>
            <div class="星期标签" data-星期="周二">周二</div>
            <div class="星期标签" data-星期="周三">周三</div>
            <div class="星期标签" data-星期="周四">周四</div>
            <div class="星期标签" data-星期="周五">周五</div>
        </div>
      
        <div class="课程内容" id="课程列表">
            <!-- 课程卡片将通过JavaScript动态生成 -->
        </div>
        
        <!-- 课程表格容器 -->
        <div class="课程表格容器" id="课程表格容器">
            <table class="课程表格" id="课程表格">
                <!-- 表格内容将通过JavaScript动态生成 -->
            </table>
        </div>
        
        <!-- Todo 视图 -->
        <div id="todo视图容器" class="todo视图">
            <div class="todo容器">
                <div class="todo表单">
                    <div class="todo表单组">
                        <label for="todo标题">提醒标题</label>
                        <input type="text" id="todo标题" placeholder="输入提醒标题">
                    </div>
                    <div class="todo表单组">
                        <label for="todo内容">提醒内容</label>
                        <textarea id="todo内容" placeholder="输入提醒内容"></textarea>
                    </div>
                    <div class="todo表单组">
                        <label for="todo时间">提醒时间</label>
                        <input type="datetime-local" id="todo时间">
                    </div>
                    <button class="按钮 主按钮" onclick="添加Todo()">添加提醒</button>
                </div>
                <div id="todo列表" class="todo列表"></div>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let 当前视图 = '卡片';
        let 当前筛选星期 = '全部';
        let todo数据 = [];
        let todo定时器 = null;
        
        // 初始课程数据
        let 课程数据 = [
            { 星期: '周一', 节次: '第3节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
            { 星期: '周一', 节次: '第4节（上午）', 班级: '六2', 科目: '音乐', 教师: '薇' },
            { 星期: '周二', 节次: '第1节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
            { 星期: '周二', 节次: '第3节（上午）', 班级: '六1', 科目: '科学', 教师: '薇' },
            { 星期: '周三', 节次: '值日', 班级: '', 科目: '值日', 教师: '' },
            { 星期: '周三', 节次: '第2节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
            { 星期: '周三', 节次: '第4节（上午）', 班级: '六1', 科目: '美术', 教师: '薇' },
            { 星期: '周三', 节次: '第6节（下午）', 班级: '六1', 科目: '科学', 教师: '薇' },
            { 星期: '周四', 节次: '第1节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
            { 星期: '周四', 节次: '第3节（上午）', 班级: '六1', 科目: '劳动', 教师: '薇' },
            { 星期: '周四', 节次: '第5节（下午）', 班级: '六1', 科目: '综合', 教师: '薇' },
            { 星期: '周五', 节次: '第2节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
            { 星期: '周五', 节次: '第5节（下午）', 班级: '六1', 科目: '语文', 教师: '薇' }
        ];

        // 从本地存储加载数据
        function 加载课程数据() {
            const 保存的数据 = localStorage.getItem('课程表数据');
            if (保存的数据) {
                课程数据 = JSON.parse(保存的数据);
            }
            
            // 加载todo数据
            const 保存的todo数据 = localStorage.getItem('todo数据');
            if (保存的todo数据) {
                todo数据 = JSON.parse(保存的todo数据);
            }
            
            渲染当前视图();
        }
        
        // 渲染当前视图（卡片或表格）
        function 渲染当前视图() {
            if (当前视图 === '卡片') {
                渲染课程列表(当前筛选星期);
            } else if (当前视图 === '表格') {
                渲染课程表格(当前筛选星期);
            } else if (当前视图 === 'todo') {
                渲染Todo列表(当前筛选星期);
            }
        }
        
        // 切换视图
        function 切换视图(视图类型) {
            当前视图 = 视图类型;
            
            // 更新按钮状态
            document.getElementById('卡片视图').classList.toggle('active', 视图类型 === '卡片');
            document.getElementById('表格视图').classList.toggle('active', 视图类型 === '表格');
            document.getElementById('todo视图按钮').classList.toggle('active', 视图类型 === 'todo');
            
            // 显示/隐藏对应的容器
            document.getElementById('课程列表').style.display = 视图类型 === '卡片' ? 'grid' : 'none';
            document.getElementById('课程表格容器').style.display = 视图类型 === '表格' ? 'block' : 'none';
            document.getElementById('todo视图容器').style.display = 视图类型 === 'todo' ? 'block' : 'none';
            
            // 渲染当前视图
            渲染当前视图();
        }

        // 保存数据到本地存储
        function 保存课程数据() {
            localStorage.setItem('课程表数据', JSON.stringify(课程数据));
        }
        
        // 保存todo数据到本地存储
        function 保存Todo数据() {
            localStorage.setItem('todo数据', JSON.stringify(todo数据));
        }

        // 渲染课程列表
        function 渲染课程列表(筛选星期 = '全部') {
            当前筛选星期 = 筛选星期;
            const 课程列表 = document.getElementById('课程列表');
            课程列表.innerHTML = '';
          
            // 添加新建课程卡片
            const 新增卡片 = document.createElement('div');
            新增卡片.className = '新增课程卡片';
            新增卡片.innerHTML = `
                <div class="新增图标">+</div>
                <div>添加新课程</div>
            `;
            新增卡片.addEventListener('click', 显示添加课程表单);
            课程列表.appendChild(新增卡片);
          
            const 筛选后课程 = 筛选星期 === '全部' 
                ? 课程数据 
                : 课程数据.filter(课程 => 课程.星期 === 筛选星期);
            
            // 按星期和节次排序
            筛选后课程.sort((a, b) => {
                const 星期顺序 = ['周一', '周二', '周三', '周四', '周五'];
                const 星期索引A = 星期顺序.indexOf(a.星期);
                const 星期索引B = 星期顺序.indexOf(b.星期);
                
                if (星期索引A !== 星期索引B) {
                    return 星期索引A - 星期索引B;
                }
                
                // 按节次排序
                const 上午A = a.节次.includes('上午');
                const 上午B = b.节次.includes('上午');
                if (上午A && !上午B) return -1;
                if (!上午A && 上午B) return 1;
                
                // 提取数字进行比较，处理没有数字的情况（如'值日'）
                const 数字A匹配 = a.节次.match(/\d+/);
                const 数字B匹配 = b.节次.match(/\d+/);
                
                if (!数字A匹配 && !数字B匹配) return 0;
                if (!数字A匹配) return -1;
                if (!数字B匹配) return 1;
                
                const 数字A = parseInt(数字A匹配[0]);
                const 数字B = parseInt(数字B匹配[0]);
                return 数字A - 数字B;
            });
          
            if (筛选后课程.length === 0) {
                const 空状态 = document.createElement('div');
                空状态.className = '空状态';
                空状态.textContent = '该日期没有课程安排';
                课程列表.appendChild(空状态);
                return;
            }
          
            筛选后课程.forEach((课程, 索引) => {
                const 课程卡片 = document.createElement('div');
                课程卡片.className = '课程卡片';
                课程卡片.innerHTML = `
                    <div class="课程头">
                        <div class="课程时间">${课程.星期} | ${课程.节次}</div>
                        <div class="操作按钮">
                            <button class="图标按钮" onclick="编辑课程(${索引})">✏️</button>
                            <button class="图标按钮" onclick="删除课程(${索引})">❌</button>
                        </div>
                    </div>
                    <div class="课程详情">
                        <div class="课程科目 ${课程.科目}">${课程.科目}</div>
                        <div class="课程信息">班级: ${课程.班级 || '无'}</div>
                        <div class="课程信息">教师: ${课程.教师 || '无'}</div>
                    </div>
                    <div class="编辑表单" id="编辑表单-${索引}">
                        <div class="表单组">
                            <label>星期</label>
                            <select id="编辑-星期-${索引}">
                                <option value="周一" ${课程.星期 === '周一' ? 'selected' : ''}>周一</option>
                                <option value="周二" ${课程.星期 === '周二' ? 'selected' : ''}>周二</option>
                                <option value="周三" ${课程.星期 === '周三' ? 'selected' : ''}>周三</option>
                                <option value="周四" ${课程.星期 === '周四' ? 'selected' : ''}>周四</option>
                                <option value="周五" ${课程.星期 === '周五' ? 'selected' : ''}>周五</option>
                            </select>
                        </div>
                        <div class="表单组">
                            <label>节次</label>
                            <input type="text" id="编辑-节次-${索引}" value="${课程.节次}">
                        </div>
                        <div class="表单组">
                            <label>班级</label>
                            <input type="text" id="编辑-班级-${索引}" value="${课程.班级}">
                        </div>
                        <div class="表单组">
                            <label>科目</label>
                            <select id="编辑-科目-${索引}">
                                <option value="语文" ${课程.科目 === '语文' ? 'selected' : ''}>语文</option>
                                <option value="音乐" ${课程.科目 === '音乐' ? 'selected' : ''}>音乐</option>
                                <option value="科学" ${课程.科目 === '科学' ? 'selected' : ''}>科学</option>
                                <option value="美术" ${课程.科目 === '美术' ? 'selected' : ''}>美术</option>
                                <option value="劳动" ${课程.科目 === '劳动' ? 'selected' : ''}>劳动</option>
                                <option value="综合" ${课程.科目 === '综合' ? 'selected' : ''}>综合</option>
                                <option value="值日" ${课程.科目 === '值日' ? 'selected' : ''}>值日</option>
                            </select>
                        </div>
                        <div class="表单组">
                            <label>教师</label>
                            <input type="text" id="编辑-教师-${索引}" value="${课程.教师}">
                        </div>
                        <div class="表单按钮">
                            <button class="按钮 主按钮" onclick="保存编辑(${索引})">保存</button>
                            <button class="按钮 次按钮" onclick="取消编辑(${索引})">取消</button>
                        </div>
                    </div>
                `;
                课程列表.appendChild(课程卡片);
            });
        }

        // 显示添加课程表单
        function 显示添加课程表单() {
            const 表单HTML = `
                <div class="课程卡片">
                    <div class="课程头">
                        <div class="课程时间">添加新课程</div>
                    </div>
                    <div class="编辑表单" style="display: block;">
                        <div class="表单组">
                            <label>星期</label>
                            <select id="新增-星期">
                                <option value="周一">周一</option>
                                <option value="周二">周二</option>
                                <option value="周三">周三</option>
                                <option value="周四">周四</option>
                                <option value="周五">周五</option>
                            </select>
                        </div>
                        <div class="表单组">
                            <label>节次</label>
                            <input type="text" id="新增-节次" placeholder="例如：第1节（上午）">
                        </div>
                        <div class="表单组">
                            <label>班级</label>
                            <input type="text" id="新增-班级" placeholder="例如：六1">
                        </div>
                        <div class="表单组">
                            <label>科目</label>
                            <select id="新增-科目">
                                <option value="语文">语文</option>
                                <option value="音乐">音乐</option>
                                <option value="科学">科学</option>
                                <option value="美术">美术</option>
                                <option value="劳动">劳动</option>
                                <option value="综合">综合</option>
                                <option value="值日">值日</option>
                            </select>
                        </div>
                        <div class="表单组">
                            <label>教师</label>
                            <input type="text" id="新增-教师" placeholder="例如：薇">
                        </div>
                        <div class="表单按钮">
                            <button class="按钮 主按钮" onclick="添加课程()">添加</button>
                            <button class="按钮 次按钮" onclick="取消添加()">取消</button>
                        </div>
                    </div>
                </div>
            `;
            
            const 课程列表 = document.getElementById('课程列表');
            课程列表.innerHTML = 表单HTML + 课程列表.innerHTML;
        }

        // 添加新课程
        function 添加课程() {
            const 新课程 = {
                星期: document.getElementById('新增-星期').value,
                节次: document.getElementById('新增-节次').value,
                班级: document.getElementById('新增-班级').value,
                科目: document.getElementById('新增-科目').value,
                教师: document.getElementById('新增-教师').value
            };
            
            if (!新课程.节次) {
                alert('请输入节次信息');
                return;
            }
            
            课程数据.push(新课程);
            保存课程数据();
            渲染课程列表();
        }

        // 取消添加
        function 取消添加() {
            渲染课程列表();
        }

        // 编辑课程
        function 编辑课程(索引) {
            // 隐藏所有编辑表单
            document.querySelectorAll('.编辑表单').forEach(表单 => {
                表单.style.display = 'none';
            });
            
            // 显示当前编辑表单
            const 编辑表单 = document.getElementById(`编辑表单-${索引}`);
            编辑表单.style.display = 'block';
        }

        // 保存编辑
        function 保存编辑(索引) {
            课程数据[索引] = {
                星期: document.getElementById(`编辑-星期-${索引}`).value,
                节次: document.getElementById(`编辑-节次-${索引}`).value,
                班级: document.getElementById(`编辑-班级-${索引}`).value,
                科目: document.getElementById(`编辑-科目-${索引}`).value,
                教师: document.getElementById(`编辑-教师-${索引}`).value
            };
            
            保存课程数据();
            渲染课程列表();
        }

        // 取消编辑
        function 取消编辑(索引) {
            const 编辑表单 = document.getElementById(`编辑表单-${索引}`);
            编辑表单.style.display = 'none';
        }

        // 删除课程
        function 删除课程(索引) {
            if (confirm('确定要删除这门课程吗？')) {
                课程数据.splice(索引, 1);
                保存课程数据();
                渲染课程列表();
            }
        }

        // 重置课程表
        function 重置课程表() {
            if (confirm('确定要重置课程表吗？所有修改将被清除！')) {
                localStorage.removeItem('课程表数据');
                课程数据 = [
                    { 星期: '周一', 节次: '第3节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
                    { 星期: '周一', 节次: '第4节（上午）', 班级: '六2', 科目: '音乐', 教师: '薇' },
                    { 星期: '周二', 节次: '第1节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
                    { 星期: '周二', 节次: '第3节（上午）', 班级: '六1', 科目: '科学', 教师: '薇' },
                    { 星期: '周三', 节次: '值日', 班级: '', 科目: '值日', 教师: '' },
                    { 星期: '周三', 节次: '第2节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
                    { 星期: '周三', 节次: '第4节（上午）', 班级: '六1', 科目: '美术', 教师: '薇' },
                    { 星期: '周三', 节次: '第6节（下午）', 班级: '六1', 科目: '科学', 教师: '薇' },
                    { 星期: '周四', 节次: '第1节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
                    { 星期: '周四', 节次: '第3节（上午）', 班级: '六1', 科目: '劳动', 教师: '薇' },
                    { 星期: '周四', 节次: '第5节（下午）', 班级: '六1', 科目: '综合', 教师: '薇' },
                    { 星期: '周五', 节次: '第2节（上午）', 班级: '六1', 科目: '语文', 教师: '薇' },
                    { 星期: '周五', 节次: '第5节（下午）', 班级: '六1', 科目: '语文', 教师: '薇' }
                ];
                保存课程数据();
                渲染课程列表();
            }
        }

        // 渲染课程表格
        function 渲染课程表格(筛选星期 = '全部') {
            当前筛选星期 = 筛选星期;
            const 课程表格 = document.getElementById('课程表格');
            
            // 获取所有节次
            const 所有节次 = [];
            课程数据.forEach(课程 => {
                if (!所有节次.includes(课程.节次)) {
                    所有节次.push(课程.节次);
                }
            });
            
            // 排序节次，值日放在最前面
            所有节次.sort((a, b) => {
                // 值日永远在最前面
                if (a === '值日') return -1;
                if (b === '值日') return 1;
                
                const 上午A = a.includes('上午');
                const 上午B = b.includes('上午');
                if (上午A && !上午B) return -1;
                if (!上午A && 上午B) return 1;
                
                // 提取数字进行比较
                const 数字A匹配 = a.match(/\d+/);
                const 数字B匹配 = b.match(/\d+/);
                
                if (!数字A匹配 && !数字B匹配) return 0;
                if (!数字A匹配) return -1;
                if (!数字B匹配) return 1;
                
                const 数字A = parseInt(数字A匹配[0]);
                const 数字B = parseInt(数字B匹配[0]);
                return 数字A - 数字B;
            });
            
            // 确定要显示的星期
            const 显示星期 = ['周一', '周二', '周三', '周四', '周五'];
            
            // 创建表格HTML
            let 表格HTML = `
                <thead>
                    <tr>
                        <th>节次</th>
            `;
            
            // 添加星期表头
            显示星期.forEach(星期 => {
                表格HTML += `<th>${星期}</th>`;
            });
            
            表格HTML += `
                    </tr>
                </thead>
                <tbody>
            `;
            
            // 添加每行数据
            所有节次.forEach(节次 => {
                表格HTML += `<tr>
                    <td>${节次}</td>`;
                
                显示星期.forEach(星期 => {
                    // 如果筛选星期不是'全部'，只显示筛选星期的数据
                    if (筛选星期 !== '全部' && 星期 !== 筛选星期) {
                        表格HTML += `<td class="空单元格"></td>`;
                        return;
                    }
                    
                    // 查找该星期该节次的课程
                    const 课程 = 课程数据.find(c => c.星期 === 星期 && c.节次 === 节次);
                    
                    if (课程) {
                        表格HTML += `
                            <td class="课程单元格">
                                <div class="科目标签 ${课程.科目}">${课程.科目}</div>
                                ${课程.班级 ? `<div class="班级信息">${课程.班级}</div>` : ''}
                                ${课程.教师 ? `<div class="教师信息">${课程.教师}</div>` : ''}
                            </td>
                        `;
                    } else {
                        表格HTML += `<td class="空单元格"></td>`;
                    }
                });
                
                表格HTML += `</tr>`;
            });
            
            表格HTML += `
                </tbody>
            `;
            
            // 设置表格内容
            课程表格.innerHTML = 表格HTML;
        }
        
        // 导出课程表
        function 导出课程表() {
            const 导出数据 = JSON.stringify(课程数据, null, 2);
            const 导出blob = new Blob([导出数据], { type: 'application/json' });
            const 导出链接 = document.createElement('a');
            导出链接.href = URL.createObjectURL(导出blob);
            导出链接.download = '我的课程表.json';
            导出链接.click();
        }

        /* Todo 功能 */
        
        // 添加Todo
        function 添加Todo() {
            const 标题 = document.getElementById('todo标题').value.trim();
            const 内容 = document.getElementById('todo内容').value.trim();
            const 时间 = document.getElementById('todo时间').value;
            
            if (!标题 || !时间) {
                alert('请填写标题和提醒时间');
                return;
            }
            
            const 时间对象 = new Date(时间);
            const 星期几 = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'][时间对象.getDay()];
            
            const 新todo = {
                id: Date.now(),
                标题: 标题,
                内容: 内容,
                时间: 时间对象.getTime(),
                星期几: 星期几,
                已完成: false,
                已提醒: false
            };
            
            todo数据.push(新todo);
            保存Todo数据();
            渲染Todo列表();
            
            // 清空表单
            document.getElementById('todo标题').value = '';
            document.getElementById('todo内容').value = '';
            document.getElementById('todo时间').value = '';
            
            // 启动定时器检查
            启动Todo定时器();
        }
        
        // 渲染Todo列表（按日期分组）
        function 渲染Todo列表(筛选星期 = '全部') {
            const todo列表 = document.getElementById('todo列表');
            const 当前时间 = Date.now();
            
            if (todo数据.length === 0) {
                todo列表.innerHTML = '<div class="空状态">暂无提醒事项</div>';
                return;
            }
            
            // 按时间排序
            let 排序数据 = [...todo数据].sort((a, b) => a.时间 - b.时间);
            
            // 星期筛选
            if (筛选星期 !== '全部') {
                排序数据 = 排序数据.filter(todo => todo.星期几 === 筛选星期);
            }
            
            // 按日期分组
            const 分组数据 = {};
            排序数据.forEach(todo => {
                const 日期 = new Date(todo.时间).toLocaleDateString('zh-CN');
                if (!分组数据[日期]) {
                    分组数据[日期] = [];
                }
                分组数据[日期].push(todo);
            });
            
            let html = '';
            
            // 按日期顺序显示分组
            Object.keys(分组数据).sort((a, b) => new Date(a) - new Date(b)).forEach(日期 => {
                html += `
                    <div class="todo日期分组">
                        <div class="todo日期标题">📅 ${日期}</div>
                        <div class="todo日期内容">
                `;
                
                分组数据[日期].forEach(todo => {
                    const 时间 = new Date(todo.时间);
                    const 是否过期 = todo.时间 < 当前时间 && !todo.已完成;
                    const 是否已完成 = todo.已完成;
                    
                    html += `
                        <div class="todo卡片 ${是否过期 ? '过期' : ''} ${是否已完成 ? '已完成' : ''}" data-id="${todo.id}" data-星期="${todo.星期几}">
                            <div class="todo标题">${todo.标题}</div>
                            ${todo.内容 ? `<div class="todo内容">${todo.内容}</div>` : ''}
                            <div class="todo时间">
                                📅 ${todo.星期几} ⏰ ${时间.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })}
                                ${是否过期 ? ' (已过期)' : ''}
                                ${todo.已提醒 ? ' 🔔' : ''}
                            </div>
                            <div class="todo操作">
                                ${!是否已完成 ? `
                                    <button class="todo按钮 todo完成按钮" onclick="完成Todo(${todo.id})">✅ 完成</button>
                                ` : ''}
                                <button class="todo按钮 todo删除按钮" onclick="删除Todo(${todo.id})">🗑️ 删除</button>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            todo列表.innerHTML = html;
        }
        
        // 完成Todo
        function 完成Todo(id) {
            const todo = todo数据.find(t => t.id === id);
            if (todo) {
                todo.已完成 = true;
                保存Todo数据();
                渲染Todo列表();
            }
        }
        
        // 删除Todo
        function 删除Todo(id) {
            if (confirm('确定要删除这个提醒吗？')) {
                todo数据 = todo数据.filter(t => t.id !== id);
                保存Todo数据();
                渲染Todo列表();
            }
        }
        
        // 保存Todo数据到本地存储
        function 保存Todo数据() {
            localStorage.setItem('todo数据', JSON.stringify(todo数据));
        }
        
        // 发送Bard提醒
        async function 发送Bard提醒(标题, 内容) {
            try {
                const 推送内容 = 内容 ? `${标题}\n${内容}` : 标题;
                const 编码内容 = encodeURIComponent(推送内容);
                const url = `https://api.day.app/psWrS4zi9b9odEuEJvfe8b/${encodeURIComponent(标题)}/${编码内容}`;
                
                const response = await fetch(url, {
                    method: 'GET'
                });
                
                if (response.ok) {
                    console.log('Bard提醒发送成功');
                } else {
                    console.error('Bard提醒发送失败:', response.status);
                }
            } catch (error) {
                console.error('发送提醒时出错:', error);
            }
        }
        
        // 启动Todo定时器
        function 启动Todo定时器() {
            if (todo定时器) {
                clearInterval(todo定时器);
            }
            
            todo定时器 = setInterval(() => {
                const 当前时间 = Date.now();
                
                todo数据.forEach(todo => {
                    if (!todo.已完成 && !todo.已提醒 && todo.时间 <= 当前时间 + 60000) {
                        // 在提醒时间前后1分钟内发送提醒
                        发送Bard提醒(todo.标题, todo.内容);
                        todo.已提醒 = true;
                        保存Todo数据();
                    }
                });
                
                渲染Todo列表();
            }, 30000); // 每30秒检查一次
        }
        
        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            加载课程数据();
            渲染当前视图();
            启动Todo定时器();
            
            // 视图切换按钮
            document.getElementById('卡片视图').addEventListener('click', function() {
                切换视图('卡片');
            });
            document.getElementById('表格视图').addEventListener('click', function() {
                切换视图('表格');
            });
            document.getElementById('todo视图按钮').addEventListener('click', function() {
                切换视图('todo');
            });
            
            // 星期筛选
            document.querySelectorAll('.星期标签').forEach(标签 => {
                标签.addEventListener('click', function() {
                    document.querySelectorAll('.星期标签').forEach(t => t.classList.remove('活跃'));
                    this.classList.add('活跃');
                    const 星期 = this.getAttribute('data-星期');
                    当前筛选星期 = 星期;
                    渲染当前视图();
                });
            });
        });
    </script>
</body>
</html>
